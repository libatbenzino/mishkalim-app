<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <title>ניהול משטחים</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
</head>

<body class="bg-gray-100 font-sans">

  <!-- ... HEADER, FORM, TABLE (אותו קוד כמו שלך) ... -->

  <table id="table" class="min-w-full table-auto border text-center">
    <thead class="bg-gray-200">
      <tr>
        <th class="p-2">מספר משטח</th>
        <th class="p-2">חבית 1 (ק"ג)</th>
        <th class="p-2">חבית 2 (ק"ג)</th>
        <th class="p-2">חבית 3 (ק"ג)</th>
        <th class="p-2">חבית 4 (ק"ג)</th>
        <th class="p-2">סה"כ משקל (ק"ג)</th>
        <th class="p-2">פעולות</th>
      </tr>
    </thead>
    <tbody id="table-body">
      <tr class="bg-white border-b">
        <td class="p-2">OF458755</td>
        <td><input type="number" value="45" class="p-1 border rounded w-20" /></td>
        <td><input type="number" value="587" class="p-1 border rounded w-20" /></td>
        <td><input type="number" value="565" class="p-1 border rounded w-20" /></td>
        <td><input type="number" value="487" class="p-1 border rounded w-20" /></td>
        <td class="total p-2 font-bold">1684.0</td>
        <td><button onclick="removeRow(this)" class="text-red-600">🗑️</button></td>
      </tr>
    </tbody>
  </table>

  <button onclick="exportPDF()" class="bg-green-600 text-white px-4 py-2 m-4 rounded">ייצא ל-PDF</button>

  <script>
    const { jsPDF } = window.jspdf;

    function exportPDF() {
      const doc = new jsPDF({ orientation: 'landscape', unit: 'pt' });

      // ⬇️ הוספת פונט בעברית מסוג Alef בפורמט base64
      doc.addFileToVFS("Alef-Regular.ttf", "AAEAAAASAQAABAAgR0RFRrRCsIIAAEAAAACcG..."); // מקוצר כאן
      doc.addFont("Alef-Regular.ttf", "Alef", "normal");
      doc.setFont("Alef");
      doc.setFontSize(14);

      doc.text("רשימת משטחים", 750, 40, { align: "right" });

      const rows = [];
      const tableRows = document.querySelectorAll('#table tbody tr');

      tableRows.forEach(row => {
        const palletId = row.cells[0].innerText.trim();
        const weights = Array.from(row.querySelectorAll('input')).map(i => i.value.trim());
        const total = row.cells[5].innerText.trim();
        rows.push([palletId, ...weights, total]);
      });

      doc.autoTable({
        head: [['מספר משטח', 'חבית 1 (ק"ג)', 'חבית 2 (ק"ג)', 'חבית 3 (ק"ג)', 'חבית 4 (ק"ג)', 'סה"כ']],
        body: rows,
        startY: 60,
        styles: {
          font: "Alef",
          fontSize: 12,
          halign: "right"
        },
        headStyles: {
          fillColor: [41, 128, 185],
          textColor: 255
        },
        margin: { left: 40, right: 40 }
      });

      doc.save("רשימת_משטחים.pdf");
    }
  </script>
</body>
</html>

