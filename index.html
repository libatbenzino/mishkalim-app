<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>× ×™×”×•×œ ××©×˜×—×™×</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    @media print {
      body * {
        visibility: hidden;
      }

      #print-area,
      #print-area * {
        visibility: visible;
      }

      #print-area {
        position: absolute;
        top: 0;
        right: 0;
        left: 0;
        padding: 20px;
        background: white;
      }
    }
  </style>
</head>

<body class="bg-gray-100 font-sans">
  <header class="bg-gradient-to-r from-blue-600 to-blue-400 text-white p-6 shadow">
    <div class="container mx-auto text-center">
      <h1 class="text-2xl font-bold">× ×™×”×•×œ ××©×˜×—×™× ×•××©×§×œ×™ ×—×‘×™×•×ª</h1>
      <p class="text-sm">×”×–× ×ª ××©×§×œ×™ ×—×‘×™×•×ª ×œ×¤×™ ××¡×¤×¨ ××©×˜×—</p>
    </div>
  </header>

  <main class="container mx-auto p-4 space-y-6">
    <section class="bg-white p-4 rounded shadow">
      <h2 class="text-lg font-bold mb-2">×”×•×¡×¤×ª ××©×˜×— ×—×“×©</h2>
      <div class="flex flex-col sm:flex-row items-center gap-2">
        <input id="pallet-id-input" type="text" placeholder="OF149875 :×“×•×’××”" class="border p-2 rounded flex-1" />
        <button onclick="addRow()" class="bg-blue-600 text-white px-4 py-2 rounded">×”×•×¡×£ ××©×˜×—</button>
      </div>
    </section>

    <section id="print-area" class="bg-white p-4 rounded shadow overflow-x-auto">
      <div class="flex flex-wrap gap-2 mb-4">
        <button onclick="printTable()" class="bg-gray-700 text-white px-4 py-2 rounded">×”×“×¤×¡ ×˜×‘×œ×”</button>
        <button onclick="exportPDF()" class="bg-green-600 text-white px-4 py-2 rounded">×™×™×¦× ×œ-PDF</button>
        <button onclick="clearTable()" class="bg-red-600 text-white px-4 py-2 rounded">× ×§×” ×”×›×œ</button>
      </div>

      <table id="table" class="min-w-full table-auto border text-center">
        <thead class="bg-gray-200">
          <tr>
            <th class="p-2">××¡×¤×¨ ××©×˜×—</th>
            <th class="p-2">×—×‘×™×ª 1 (×§"×’)</th>
            <th class="p-2">×—×‘×™×ª 2 (×§"×’)</th>
            <th class="p-2">×—×‘×™×ª 3 (×§"×’)</th>
            <th class="p-2">×—×‘×™×ª 4 (×§"×’)</th>
            <th class="p-2">×¡×”"×› ××©×§×œ (×§"×’)</th>
            <th class="p-2">×¤×¢×•×œ×•×ª</th>
          </tr>
        </thead>
        <tbody id="table-body"></tbody>
      </table>

      <p class="mt-4 font-bold" id="summary">×¡×™×›×•×: 0 ××©×˜×—×™×, 0 ×§"×’ ×¡×”"×›</p>
    </section>
  </main>

  <footer class="bg-gray-800 text-white text-center p-4 mt-10">
    ××¢×¨×›×ª × ×™×”×•×œ ××©×˜×—×™× ×•××©×§×œ×™ ×—×‘×™×•×ª Â© 2023
  </footer>

  <script>
    let rowCount = 0;

    function addRow(palletId = null, weights = []) {
      const input = document.getElementById('pallet-id-input');
      const id = palletId || input.value.trim();
      if (!id) {
        alert('× × ×œ×”×–×™×Ÿ ××¡×¤×¨ ××©×˜×— ×œ×¤× ×™ ×”×•×¡×¤×”');
        return;
      }

      const tbody = document.getElementById('table-body');
      const row = document.createElement('tr');
      row.className = 'bg-white border-b';

      let inputsHTML = '';
      for (let i = 0; i < 4; i++) {
        const val = weights[i] || '';
        inputsHTML += `<td><input type="number" class="p-1 border rounded w-20" value="${val}" onchange="updateWeight(this)" /></td>`;
      }

      row.innerHTML = `
        <td class="p-2">${id}</td>
        ${inputsHTML}
        <td class="total p-2 font-bold">0</td>
        <td><button onclick="removeRow(this)" class="text-red-600">ğŸ—‘ï¸</button></td>
      `;

      tbody.appendChild(row);
      rowCount++;
      input.value = '';
      updateWeight(row.querySelector('input'));
      updateSummary();
      saveTableToStorage();
    }

    function removeRow(btn) {
      btn.closest('tr').remove();
      rowCount--;
      updateSummary();
      saveTableToStorage();
    }

    function updateWeight(input) {
      const row = input.closest('tr');
      const inputs = row.querySelectorAll('input');
      let sum = 0;
      inputs.forEach(i => sum += parseFloat(i.value) || 0);
      row.querySelector('.total').innerText = sum.toFixed(1);
      updateSummary();
      saveTableToStorage();
    }

    function updateSummary() {
      const totals = document.querySelectorAll('.total');
      let sum = 0;
      totals.forEach(t => sum += parseFloat(t.innerText) || 0);
      document.getElementById('summary').innerText = `×¡×™×›×•×: ${rowCount} ××©×˜×—×™×, ${sum.toFixed(1)} ×§"×’ ×¡×”"×›`;
    }

    function clearTable() {
      document.getElementById('table-body').innerHTML = '';
      rowCount = 0;
      updateSummary();
      localStorage.removeItem('palletData');
    }

    function printTable() {
      const printContents = document.getElementById('print-area').innerHTML;
      const printWindow = window.open('', '', 'width=800,height=600');
      printWindow.document.write('<html><head><title>×”×“×¤×¡ ×˜×‘×œ×”</title>');
      printWindow.document.write('<style>table { width: 100%; border-collapse: collapse; } th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }</style>');
      printWindow.document.write('</head><body dir="rtl">');
      printWindow.document.write(printContents);
      printWindow.document.write('</body></html>');
      printWindow.document.close();
      printWindow.focus();
      printWindow.print();
      printWindow.close();
    }

    function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({ orientation: 'landscape' });
      doc.setFont('helvetica');
      doc.setFontSize(12);
      doc.text('×¨×©×™××ª ××©×˜×—×™×', 10, 10);

      let y = 20;
      document.querySelectorAll('#table tbody tr').forEach(row => {
        const cells = row.querySelectorAll('td');
        const data = Array.from(cells).slice(0, 6).map(c => c.innerText.trim());
        doc.text(data.join(' | '), 10, y);
        y += 10;
      });

      doc.save('×¨×©×™××ª_××©×˜×—×™×.pdf');
    }

    function saveTableToStorage() {
      const rows = document.querySelectorAll('#table tbody tr');
      const data = Array.from(rows).map(row => {
        const id = row.cells[0].innerText.trim();
        const inputs = row.querySelectorAll('input');
        const weights = Array.from(inputs).map(i => i.value.trim());
        return { id, weights };
      });
      localStorage.setItem('palletData', JSON.stringify(data));
    }

    function loadTableFromStorage() {
      const data = JSON.parse(localStorage.getItem('palletData') || '[]');
      data.forEach(item => addRow(item.id, item.weights));
    }

    // ×˜×¢×Ÿ ××”××—×¡×•×Ÿ ×”××§×•××™ ×›×©× ×›× ×¡ ×”×“×£
    window.onload = loadTableFromStorage;
  </script>
</body>

</html>


